(this.webpackJsonpreactchat2=this.webpackJsonpreactchat2||[]).push([[0],{100:function(e,t,a){},144:function(e,t,a){e.exports=a(253)},253:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(47),c=a.n(s),o=(a(100),a(16)),i=a(56),l=(a(42),a(4)),u=a(5),m=a.n(u),d=a(8),p=a(17),f=a(18),h=a(20),g=a(19),v=a(44),b=a.n(v),j=(a(170),null);b.a.apps.length?(b.a.app(),j=b.a.storage()):(b.a.initializeApp({apiKey:"AIzaSyC6zWRnYvgSfWF7AfsqCCaL18YKD4VIOkI",authDomain:"reactchat-3a4dc.firebaseapp.com",databaseURL:"https://reactchat-3a4dc.firebaseio.com",projectId:"reactchat-3a4dc",storageBucket:"reactchat-3a4dc.appspot.com",messagingSenderId:"71361254830",appId:"1:71361254830:web:cc7cf5c53d164db98ae43f",measurementId:"G-6Z255M0NRW"}),j=b.a.storage());a(70);var E=a(32),O=a.n(E),C=a(30),w=(a(171),a(26)),y=a(49),S=Object(y.b)({name:"member",initialState:{username:"",avatar:"",emailAddress:"",color:"",showregisterform:"",showvideocall:""},reducers:{setUsername:function(e){e.username=e.nickname},setAvatar:function(e){e.avatar=e.picture},setEmailAddress:function(e){e.emailAddress=e.email},setShowRegisterForm:function(e,t){e.showregisterform+=t.payload},setShowVideoCall:function(e,t){e.showvideocall+=t.payload},setColor:function(e){e.color=e.selectedcolor},incrementByAmount:function(e,t){e.username+=t.payload},incrementByAvatar:function(e,t){e.avatar+=t.payload},incrementEmailByAmount:function(e,t){e.emailAddress+=t.payload},incrementColor:function(e,t){e.color+=t.payload}}}),k=S.actions,x=(k.setUsername,k.setAvatar,k.setColor,k.incrementByAmount),I=(k.incrementEmailByAmount,k.incrementByAvatar),L=(k.incrementColor,k.setShowRegisterForm,k.setShowVideoCall),N=function(e){return e.member.username},V=function(e){return e.member.color},U=function(e){return e.member.showregisterform},T=function(e){return e.member.showvideocall},_=function(e){return e.member.avatar},A=function(e){return e.member.emailAddress},D=S.reducer;a(172),a(244);var B=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){navigator.mediaDevices.getUserMedia({video:!0}).then((function(e){return n.videoTag.current.srcObject=e})).catch(console.log)},n.handleVideo=function(e){n.setState({videoSrc:e})},n.videoError=function(){},n.closeCall=function(){var e=n.props.id;b.a.database().ref("calls/"+e).update({deleted:!0})},n.onStartCallClicked=function(){b.a.database().ref("calls").push({from:n.props.user,to:n.state.userToCall,rejected:!1,accepted:!1,deleted:!1}),n.setState({loading:!0})},n.renderVideos=function(){return r.a.createElement("video",{id:n.props.id,ref:n.videoTag,width:n.props.width,height:n.props.height,autoPlay:!0,title:n.props.title})},n.renderForms=function(){return r.a.createElement("div",{key:"a",className:"form"},r.a.createElement("label",null,n.props.user," Call to"),r.a.createElement("input",{value:n.state.userToCall,type:"text",onChange:function(e){return n.setState({userToCall:e.target.value})}}),r.a.createElement("button",{onClick:n.onStartCallClicked,id:"call-btn",className:"btn btn-primary"},"Call"))},n.state={userToCall:null,loading:!1},n.closeCall=n.closeCall.bind(Object(C.a)(n)),n.videoTag=r.a.createRef(),n}return Object(f.a)(a,[{key:"render",value:function(){var e="",t="";return this.props.connectedUser&&(e=r.a.createElement(o.a,{onClick:this.closeCall,className:"close call",icon:w.c})),this.state.loading&&(t="Calling..."),r.a.createElement("div",{id:"camera-body"},r.a.createElement("section",{id:"container"},this.props.connectedUser?null:this.renderForms(),this.renderVideos(),t,e))}}]),a}(r.a.Component),M=function(){var e=Object(d.a)(m.a.mark((function e(t,a,n,r,s,c){var o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.addStream(a),e.next=4,t.createOffer();case 4:return o=e.sent,e.next=7,t.setLocalDescription(o);case 7:r(n,o,s,c),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,a,n,r,s,c){return e.apply(this,arguments)}}(),R=function(){var e=Object(d.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 3:return t=e.sent,e.abrupt("return",t);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=Object(d.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=new RTCPeerConnection({iceServers:[{urls:"stun:stun2.1.google.com:19302"}]}),e.abrupt("return",t);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),J=function(e,t,a,n,r,s){e.onicecandidate=function(e){e.candidate&&s(a,e.candidate,n,t)},e.ontrack=function(e){r.srcObject!==e.streams[0]&&(r.srcObject=e.streams[0])}},W=function(){var e=Object(d.a)(m.a.mark((function e(t,a,n,r,s,c){var o,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.addStream(a),o=JSON.parse(n.offer),t.setRemoteDescription(o),e.next=6,t.createAnswer();case 6:i=e.sent,t.setLocalDescription(i),r(n.from,i,s,c),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,a,n,r,s,c){return e.apply(this,arguments)}}(),z=function(){var e=Object(d.a)(m.a.mark((function e(t,a,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.ref("/notifs/"+t).remove();case 2:a.ref("/notifs/"+t).on("value",(function(e){e.exists()&&n(e.val(),t)}));case 3:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),Y=function(){var e=Object(d.a)(m.a.mark((function e(t,a,n,r){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.ref("/notifs/"+t).set({type:"offer",from:r,offer:JSON.stringify(a)});case 2:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),H=function(){var e=Object(d.a)(m.a.mark((function e(t,a,n,r){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.ref("/notifs/"+t).update({type:"answer",from:r,answer:JSON.stringify(a)});case 2:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),P=function(){var e=Object(d.a)(m.a.mark((function e(t,a,n,r){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.ref("/notifs/"+t).update({type:"candidate",from:r,candidate:JSON.stringify(a)});case 2:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),K=a(48),Z=a.n(K);a(139);console.log(O.a.name),console.log(O.a.database());r.a.Component;var q=function(e){var t=Object(l.c)(N),a=Object(l.c)(_),n=(Object(l.c)(V),Object(l.b)());return r.a.createElement("div",{className:"contact-profile"},r.a.createElement("img",{src:a,alt:""}),r.a.createElement("p",null,t),r.a.createElement("div",{className:"social-media"},r.a.createElement("a",{target:"_blank",href:"https://www.instagram.com/reactjsofficial/"},r.a.createElement(o.a,{icon:i.b})),r.a.createElement("a",{target:"_blank",href:"https://www.facebook.com/groups/reacttr/"},r.a.createElement(o.a,{icon:i.a})),r.a.createElement("a",{target:"_blank",href:"https://twitter.com/reactjs"},r.a.createElement(o.a,{icon:i.c})),r.a.createElement(o.a,{onClick:function(){return n(L("true"))},icon:w.d})))},G=a(143),$=a.n(G),Q=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).onEmojiClick=function(e,t){n.setChosenEmoji(t)},n.setChosenEmoji=function(e){var t=n.state.message;t+=e.emoji,n.setState({message:t}),n.setState({emojiVisible:!1})},n.sendMessage=function(e){e.preventDefault();var t=b.a.database().ref("messages"),a=n.state.messageList,r=n.state.fileUrl,s=n.state.message;null!=r&&r.length>0&&(s=r),t.push({message:s,date:Date.now(),username:n.props.Username,color:n.props.Color,deleted:!1,isImage:n.state.isImage,isVideo:n.state.isVideo}),n.setState({fileUrl:""}),n.setState({messageList:a,message:""}),n.setState({isImage:!1,isVideo:!1})},n.state={messageList:[],message:"",image:"",video:"",username:n.props.Username,color:n.props.Color,fileName:"",isVideo:!1,isImage:!1,chosenEmoji:null,setChosenEmoji:null,emojiVisible:!1},n.sendMessage=n.sendMessage.bind(Object(C.a)(n)),n.handleMessage=n.handleMessage.bind(Object(C.a)(n)),n}return Object(f.a)(a,[{key:"handleMessage",value:function(e){this.setState({message:e.target.value})}},{key:"showEmoji",value:function(){this.state.emojiVisible?this.setState({emojiVisible:!1}):this.setState({emojiVisible:!0})}},{key:"addEmoji",value:function(e){var t=this.state.message;t+=e.target.textContent,this.setState({message:t})}},{key:"onVideoChange",value:function(e){var t=this,a=new FileReader,n=(new Date).getTime(),r=e.target.files[0];r?(a.onload=function(){if(2===a.readyState){var e=r.name.split(".")[1];if(console.log(r),t.setState({video:r}),r)j.ref().child(n+"."+e).put(r).then((function(e){return e.ref.getDownloadURL()})).then((function(e){t.setState({fileName:r.name}),t.setState({fileUrl:e}),t.setState({isVideo:!0}),alert("Video Ba\u015far\u0131yla Y\xfcklendi")}));else alert("L\xfctfen Video Se\xe7iniz.")}},a.readAsDataURL(e.target.files[0])):this.setState({this:null})}},{key:"onImageChange",value:function(e){var t=this,a=new FileReader,n=(new Date).getTime(),r=e.target.files[0];r?(a.onload=function(){if(2===a.readyState){var e=r.name.split(".")[1];if(console.log(r),t.setState({image:r}),r)j.ref().child(n+"."+e).put(r).then((function(e){return e.ref.getDownloadURL()})).then((function(e){t.setState({fileName:r.name}),t.setState({fileUrl:e}),t.setState({isImage:!0}),alert("Foto\u011fraf Ba\u015far\u0131yla Y\xfcklendi")}));else alert("L\xfctfen Foto\u011fraf Se\xe7iniz.")}},a.readAsDataURL(e.target.files[0])):this.setState({this:null})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"message-input"},r.a.createElement("div",{class:"wrap"},r.a.createElement("form",{onSubmit:this.sendMessage},r.a.createElement("div",{id:"emojis",className:this.state.emojiVisible?"show":"hide"},r.a.createElement($.a,{onEmojiClick:this.onEmojiClick,pickerStyle:{width:"100%",height:"400px"}})),r.a.createElement("input",{value:this.state.message,onChange:this.handleMessage,type:"text",placeholder:"Write your message..."}),r.a.createElement("input",{type:"file",id:"fileInput",accept:"image/x-png,image/jpeg,image/jpg,video/mp4",onChange:function(t){"video/mp4"==t.target.files[0].type?e.onVideoChange(t):e.onImageChange(t)}}),r.a.createElement("div",{className:"btn_class",onClick:this.showEmoji.bind(this)},"Emoji"),r.a.createElement("button",{type:"submit",className:"submit"},r.a.createElement(o.a,{icon:w.a})))))}}]),a}(r.a.Component),X=a(11);var ee=a(99),te=a(95),ae=a.n(te),ne=a(259),re=a(258),se={url:"http://localhost:3000/reactchat",handleCodeInApp:!0};function ce(e){var t=Object(l.c)(N),a=(Object(l.c)(A),Object(n.useState)("")),s=Object(X.a)(a,2),c=s[0],o=s[1],i=Object(n.useState)(""),u=Object(X.a)(i,2),m=u[0],d=u[1],p=Object(n.useState)(""),f=Object(X.a)(p,2),h=f[0],g=f[1],v=Object(n.useState)(""),j=Object(X.a)(v,2),E=(j[0],j[1],Object(l.b)()),O=""==t||null==t||void 0==t,C=Object(n.useState)(!1),w=Object(X.a)(C,2),y=w[0],S=w[1],k=Object(n.useState)({}),L=Object(X.a)(k,2),V=L[0],U=L[1],T=Object(n.useState)(""),_=Object(X.a)(T,2),D=_[0];_[1];function B(e,t,a){b.a.auth().sendSignInLinkToEmail(e,se).then((function(){Object(ee.b)(e),ee.a?(window.localStorage.setItem("emailForSignIn",e),alert("Set edildi")):alert("Email Hatal\u0131")})).catch((function(e){e.code;var t=e.message;alert(t)})),E(I(h)),E(x(t))}return O?r.a.createElement("div",{id:"LoginForm"},r.a.createElement("div",{class:"containerFacebook"},r.a.createElement(ne.a,{style:{width:"250px",height:"20px"}},r.a.createElement(ne.a.Header,null,!y&&r.a.createElement(ae.a,{appId:"971141813672064",autoLoad:!0,fields:"name,email,picture",scope:"public_profile,user_friends",callback:function(e){console.log(e),U(e),e.accessToken&&(o(e.name),d("berkerbilgen@yandex.com"),g(e.picture.data.url),B(e.email,e.name,D)),e.accessToken?S(!0):S(!1)},icon:"fa-facebook"}),y&&r.a.createElement(re.a,{src:D,roundedCircle:!0})),y&&r.a.createElement(ne.a.Body,null,r.a.createElement(ne.a.Title,null,V.name),r.a.createElement(ne.a.Text,null,V.email)))),r.a.createElement("div",{class:"login-form"},r.a.createElement("h3",null,"Who are you?"),r.a.createElement("input",{value:c,onChange:function(e){return o(e.target.value)},type:"text",placeholder:"Nickname"}),r.a.createElement("input",{value:m,onChange:function(e){return d(e.target.value)},type:"text",placeholder:"Email"}),r.a.createElement("input",{type:"password",placeholder:"Password"}),r.a.createElement("button",{onClick:function(){return B(m,c)}},"Login"))):r.a.createElement("div",null)}function oe(e){Object(l.c)(N);var t=Object(l.c)(U),a=Object(n.useState)(""),s=Object(X.a)(a,2),c=(s[0],s[1],Object(n.useState)("")),o=Object(X.a)(c,2);o[0],o[1],Object(l.b)();return"true"==t?r.a.createElement(ce,null):r.a.createElement("div",null)}var ie=Object(y.b)({name:"counter",initialState:{value:0},reducers:{increment:function(e){e.value+=1},decrement:function(e){e.value-=1},incrementByAmount:function(e,t){e.value+=t.payload}}}),le=ie.actions,ue=(le.increment,le.decrement,le.incrementByAmount,ie.reducer);a(33);var me=a(96),de=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){return Object(p.a)(this,a),t.call(this,e)}return Object(f.a)(a,[{key:"deleteMessage",value:function(e){b.a.database().ref("messages/"+e.currentTarget.getAttribute("data-id")).update({deleted:!0});var t=Z()("span[data-id='"+e.currentTarget.getAttribute("data-id")+"']");Z()(t).closest("p").html("Bu mesaj silindi")}},{key:"render",value:function(){var e="sent",t="";this.props.Sent||(e="replies",t=r.a.createElement("span",{"data-id":this.props.Id,onClick:this.deleteMessage},"Sil"));var a=new Date(this.props.Date),n=a.getUTCHours(),s=a.getUTCMinutes(),c="";if(c=this.props.IsImage?r.a.createElement("p",{className:this.props.Color},r.a.createElement("img",{className:"message-image",src:this.props.Text})):this.props.IsVideo?r.a.createElement("p",{className:this.props.Color},r.a.createElement("video",{className:"message-video",src:this.props.Text,width:"2000",height:"900",controls:!0})):r.a.createElement("p",{className:this.props.Color},this.props.Text," ",r.a.createElement("div",null," ",t," ",r.a.createElement("span",null,n,":",s))),this.props.Deleted){var o=this.props.Color+" deleted";c=r.a.createElement("p",{className:o},"Bu mesaj silindi")}return r.a.createElement("li",{className:e},r.a.createElement("img",{src:"http://emilcarlsson.se/assets/mikeross.png",alt:""}),c)}}]),a}(r.a.Component);console.log(O.a.name),console.log(O.a.database());var pe=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).componentDidMount=Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),n.accept=function(){var e=n.props.callid;O.a.database().ref("calls/"+e).update({accepted:!0})},n.reject=function(){var e=n.props.callid;O.a.database().ref("calls/"+e).update({rejected:!0,deleted:!0})},n.accept=n.accept.bind(Object(C.a)(n)),n}return Object(f.a)(a,[{key:"render",value:function(){var e=r.a.createElement("div",{class:"calling"},r.a.createElement("p",null,this.props.from," calling!"),r.a.createElement(o.a,{onClick:this.accept,className:"accept call",icon:w.b}),r.a.createElement(o.a,{onClick:this.reject,className:"reject call",icon:w.c}));return"true"==this.props.showVideo&&(e=r.a.createElement(B,{user:"",connectedUser:!0,id:this.props.callid})),e}}]),a}(r.a.Component),fe=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).state={username:n.props.Username,messageList:[],callList:[]},n}return Object(f.a)(a,[{key:"componentDidMount",value:function(){var e=this;b.a.database().ref("messages").on("value",(function(t){var a=t.val(),n=[];for(var r in a)n.push({id:r,message:a[r].message,date:a[r].date,username:a[r].username,color:a[r].color,deleted:a[r].deleted,isImage:a[r].isImage,isVideo:a[r].isVideo});e.setState({messageList:n})})),this.scrollToBottom(),b.a.database().ref("calls").on("value",(function(t){var a=t.val(),n=[];for(var r in a)n.push({id:r,from:a[r].from,to:a[r].to,accepted:a[r].accepted,rejected:a[r].rejected,deleted:a[r].deleted});e.setState({callList:n})}))}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"scrollToBottom",value:function(){me.animateScroll.scrollToBottom({containerId:"message-list"})}},{key:"render",value:function(){var e=this,t=(r.a.createRef(),this.props.Username),a=this.state.callList.filter((function(e){return e.to===t&&!1===e.accepted&&!1===e.rejected&&!1===e.deleted})),n=this.state.callList.filter((function(e){return e.to===t&&!0===e.accepted&&!1===e.rejected&&!1===e.deleted})),s="";return""!=t&&null!=a&&a.length>0&&(s=r.a.createElement(pe,{callid:a[0].id,from:a[0].from})),""!=t&&null!=n&&n.length>0&&(s=r.a.createElement(pe,{showVideo:"true",callid:n[0].id,from:n[0].from})),""!=this.props.Username?r.a.createElement("div",{id:"message-list",className:"messages"},s,r.a.createElement("div",null,r.a.createElement("ul",null,Object.keys(this.state.messageList).map((function(t){return r.a.createElement(de,{Id:e.state.messageList[t].id,Color:e.state.messageList[t].color,Sent:e.props.Username!=e.state.messageList[t].username,Username:e.state.messageList[t].username,Text:e.state.messageList[t].message,Deleted:e.state.messageList[t].deleted,IsImage:e.state.messageList[t].isImage,IsVideo:e.state.messageList[t].isVideo,Date:e.state.messageList[t].date})}))))):r.a.createElement("div",{className:"messages"})}}]),a}(r.a.Component),he=function(){var e=Object(l.c)(N),t=Object(l.c)(V),a="";return"true"==Object(l.c)(T)&&(a=r.a.createElement(B,{user:e})),r.a.createElement("div",{id:"frame"},r.a.createElement("div",{className:"content"},r.a.createElement(q,null),r.a.createElement(fe,{Username:e}),r.a.createElement(Q,{Username:e,Color:t}),r.a.createElement(oe,null),r.a.createElement(ce,null),a))},ge=Object(y.a)({reducer:{counter:ue,member:D}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(l.a,{store:ge},r.a.createElement(he,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})),b.a.auth().signOut().then((function(){})).catch((function(e){}))},33:function(e,t,a){e.exports={row:"Counter_row__3InZU",value:"Counter_value__xcC_T",button:"Counter_button__18Vrb",textbox:"Counter_textbox__ulF6J",asyncButton:"Counter_asyncButton__3Maus Counter_button__18Vrb"}}},[[144,1,2]]]);
//# sourceMappingURL=main.452d8a58.chunk.js.map